#!/usr/bin/env sh

CWD=$PWD

if [ -z "$GOPATH" ]
then
  GETH=geth
  DIR=/bordata
else
  GETH=$GOPATH/src/github.com/ethereum/go-ethereum/build/bin/geth
  DIR=$CWD
fi

mkdir $DIR/data
$GETH --datadir $DIR/data init $DIR/genesis.json
cp -rf $DIR/keystore $DIR/data/

$GETH --datadir $DIR/data \
  --port 30341 \
  --rpc --rpcaddr '0.0.0.0' \
  --rpcvhosts '*' \
  --rpccorsdomain '*' \
  --rpcport 8545 \
  --ipcpath $DIR/geth.ipc \
  --rpcapi 'personal,db,eth,net,web3,txpool,miner,admin' \
  --syncmode 'full' \
  --networkid '{{ borChainId }}' \
  --gasprice '0' \
  --unlock '0x96c42c56fdb78294f96b0cfa33c92bed7d75f96a,0x913dA4198E6bE1D5f5E4a40D0667f70C0B5430Eb,0xbd355A7e5a7ADb23b51F54027E624BfE0e238DF6' \
  --password $DIR/password.txt \
  --allow-insecure-unlock \
  --mine > $DIR/data/node.log &
tail -f $DIR/data/node.log
